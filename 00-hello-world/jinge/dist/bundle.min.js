(()=>{"use strict";function t(t){return typeof t}function e(e){return null!==e&&"object"===t(e)}function n(e){return"string"===t(e)}function r(e){return"undefined"===t(e)}function s(t){return Array.isArray(t)}function o(e){return"function"===t(e)}function i(t,e){const n=t.indexOf(e);return!(n<0||(t.splice(n,1),0))}let a=0;function l(){return Date.now().toString(32)+"-"+Math.floor(16777215*Math.random()).toString(32)+"-"+(a++).toString(32)}function c(...t){console.warn(...t)}let _,h,d=0,u=1,f=!1;function p(t){_.delete(t)}function E(t){if(f)return void setTimeout(E,0,t);const e=_.get(t);if(e){f=!0;try{e()}finally{p(t),f=!1}}}if(r(window.setImmediate)){_=new Map;const t="setImmediate$"+(d++).toString(32)+"$";window.addEventListener("message",(e=>{e.source===window&&n(e.data)&&e.data.startsWith(t)&&E(Number(e.data.slice(t.length)))}),!1),h=function(e){window.postMessage(t+e,"*")}}const g=window.setImmediate||function(t){if(!o(t)||arguments.length>1)throw new Error("setImmediate require callback function.");return _.set(u,t),h(u),u++},m=window.clearImmediate||p;function w(t){const e=document.createDocumentFragment();return t&&t.forEach((t=>{e.appendChild(n(t)?document.createTextNode(t):t)})),e}function y(t,e){t.appendChild(e.length>1?w(e):n(e[0])?function(t=""){return document.createTextNode(n(t)?t:JSON.stringify(t))}(e[0]):e[0])}function D(t,n){if(n){if(!e(n))return t.removeAttribute(n);for(const e in n)D(t,e)}}function b(t,n,s){if(n)if(e(n))for(const e in n)b(t,e,n[e]);else r(s)||null===s?D(t,n):t.setAttribute(n,s)}function x(t,e,...n){return function(t,e,n){if(e)for(const n in e)n&&!r(e[n])&&b(t,n,e[n]);return n.length>0&&y(t,n),t}(document.createElement(t),e,n)}function N(t,e,n,s){return function(t,e,n,s){r(s)&&(s=!!e.startsWith("touch")&&{capture:!1,passive:!0}),t.addEventListener(e,n,s)}(t,e,n,s),function(){!function(t,e,n){t.removeEventListener(e,n)}(t,e,n)}}const R=Symbol("$$");function O(t){return n(t)?t:null===t?"null":r(t)?"undefined":t.toString()}function v(t){return n(t)?t.indexOf(".")>0?t.split("."):[t]:s(t)?t:[t]}function T(t,e,n){if(!t.__parents)return;const r=t.__parents.findIndex((t=>t.core===e&&t.prop===n));r>=0&&t.__parents.splice(r,1)}const C=new Map;function I(t){const e=C.get(t);e&&(m(e.immediate),C.delete(t))}function S(t,e,n){const r=e.__handlers;r&&r.forEach((e=>{n?e(t):function(t,e){if(C.has(t))return;const n=g((()=>{const e=C.get(t);try{t(e.propertyPath)}finally{C.delete(t)}}));C.set(t,{immediate:n,propertyPath:e})}(e,t)}));const s=e.__listeners;s&&s.forEach((e=>{S(t,e,n)}))}function M(t,e,n,r=0){const s=t.__listeners;if(!s)return;const o=O(e[r]);if(!o)return;let i=s.get(o);i&&(e.length-1===r?S(e,i,n):M(i,e,n,r+1)),i=s.get("*"),i&&(e.length-1===r?S(e,i,!0):M(i,e,n,r+1)),i=s.get("**"),i&&S(e,i,!0)}function A(t,e,n=0){const r=O(e[n]);t.__listeners||(t.__listeners=new Map);let s=t.__listeners.get(r);return s||(s={__parent:t,__property:r,__handlers:null,__listeners:null},t.__listeners.set(r,s)),e.length-1===n?s:A(s,e,n+1)}function F(t,e,n=0){var r;const s=O(e[n]);if(!s)return null;const o=null===(r=t.__listeners)||void 0===r?void 0:r.get(s);return o?e.length-1===n?o:F(o,e,n+1):null}function L(t){const e=t.__listeners;e&&(e.forEach((t=>L(t))),t.__listeners=null);const n=t.__handlers;n&&(n.forEach(I),t.__handlers=null),t.__parent=null}class U{constructor(t){this.__notifiable=!0,this.__parents=null,this.__listeners=null,this.__related=null,this.__setters=null,this.target=t,this.proxy=null,Object.defineProperty(t,R,{value:this,writable:!1,configurable:!0,enumerable:!1})}__watch(t,e,n){const r=(t=v(t)).indexOf("**");if(r>=0&&r!==t.length-1)throw new Error('wizard "**" must be last element in path.');const s=A(this,t);s.__handlers||(s.__handlers=[]),s.__handlers.indexOf(e)<0&&s.__handlers.push(e),n&&n!==this&&n.__addRelated(this,t,e)}__unwatch(t,e,n){if(!t)return void L(this);const r=F(this,v(t));if(!r)return;const s=r.__handlers;s&&(e?(I(e),i(s,e)):(s.forEach(I),s.length=0),function(t){if(t&&t.__handlers&&t.__handlers.length>0||t.__listeners&&t.__listeners.size>0)return null;const e=t.__parent,n=t.__property;t.__parent=null,e.__listeners.delete(n)}(r),n&&n!==this&&n.__rmRelated(this,t,e))}__notify(t,e=!1){if(!this.__notifiable)return;t=v(t),this.__listeners&&M(this,t,e);const n=this.__parents;n&&n.forEach((n=>{const r=n.core;r?r.__notify([n.prop].concat(t),e):console.error("dev-warn-unexpected: parent of ViewModelCore has been destroied but not unlink.")}))}__destroy(){this.__notifiable=!1,this.__parents=null,L(this),this.proxy=null,this.__related&&(this.__related.forEach(((t,e)=>{t.forEach((t=>{e.__unwatch(t.prop,t.handler)}))})),this.__related=null);const t=this.target,n=this.__setters;n&&(n.forEach(((n,r)=>{if(null===n)return;const s=t[r];e(s)&&R in s&&T(s[R],this,r)})),this.__setters=null),Object.getOwnPropertyNames(t).forEach((n=>{const r=t[n];e(r)&&R in r&&T(r[R],this,n)})),delete t[R],this.target=null}__addRelated(t,e,n){this.__related||(this.__related=new Map);let r=this.__related.get(t);r||this.__related.set(t,r=[]),r.push({prop:e,handler:n})}__rmRelated(t,e,n){if(!this.__related)return;const r=this.__related.get(t);if(!r)return;const o=s(e),i=r.findIndex((t=>n===t.handler&&(o?function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,t.prop):e===t.prop)));i>=0&&r.splice(i,1)}}function P(t,s,o,i,a=!0){if(!n(l=s)||95===l.charCodeAt(0))return t[s]=o,!0;var l;const c=t[s];if(c===o&&!r(o))return!0;let _=e(o)&&!function(t){const e=t.constructor;return e===RegExp||e===Date||e===Boolean}(o);if(_&&(_=R in o,a&&!_))throw new Error(`public property "${s.toString()}" of ViewModel must also be ViewModel`);return e(c)&&R in c&&T(c[R],t[R],s),i(t,s,o),_&&(h=o[R],d=t[R],u=s,h.__parents||(h.__parents=[]),h.__parents.push({core:d,prop:u})),function(t,e){t[R].__notify(e)}(t,s),!0;var h,d,u}function j(t,e,n){t[e]=n}function $(t,e,n){const r=function(t,e){let n=t[R].__setters;if(n||(t[R].__setters=n=new Map),n.has(e))return n.get(e);{let r,s=t.constructor,i=Object.getOwnPropertyDescriptor(s.prototype,e);if(i)return r=o(i.set)?i.set:null,n.set(e,r),r;for(s=Object.getPrototypeOf(s);s&&s.prototype;){if(i=Object.getOwnPropertyDescriptor(s.prototype,e),i)return r=o(i.set)?i.set:null,n.set(e,r),r;s=Object.getPrototypeOf(s)}return n.set(e,null),null}}(t,e);r?r.call(t[R].proxy,n):t[e]=n}function H(t,e,n){return!(R in t)||P(t,e,n,j,!1)}function k(t,e,n){return R in t?P(t,e,n,$):(c(`call setter "${e.toString()}" after destroied, resources such as setInterval maybe not released before destroy. component:`,t),!0)}const Z=Symbol("listeners");class V{constructor(t){if(this[Z]=null,t)for(const e in t){const n=t[e];this.__on(e,n.fn,n.opts)}}__notify(t,...e){if(!this[Z])return;const n=this[Z].get(t);n&&n.forEach(((t,r)=>{r(...e),t&&t.once&&n.delete(r)}))}__on(t,e,n){this[Z]||(this[Z]=new Map);let r=this[Z].get(t);r||this[Z].set(t,r=new Map),r.set(e,n)}__off(t,e){const n=this[Z];if(!n)return;if(!t)return n.forEach((t=>t.clear())),void n.clear();const r=n.get(t);r&&(e?r.delete(e):r.clear())}}const W=new class{constructor(){this.m=new Map,this.s=0}create(t){if(0===this.s)return;const e=x("style",{type:"text/css",id:t.dom});document.head.appendChild(e),e.styleSheet?e.styleSheet.cssText=t.css:e.textContent=t.css}add(t){if(!t)return;const e=this.m;let n=e.get(t.id);n?n.refs++:(n={id:t.id,css:t.css,dom:`__${t.id}__`,refs:1},e.set(t.id,n),this.create(n))}attch(){0===this.s&&(this.s=1,function(){const t=x("span",{style:"position:absolute;left:-10000px;",class:"jg-hide"});document.body.appendChild(t);const e="none"===getComputedStyle(t).getPropertyValue("display");return document.body.removeChild(t),e}()||this.create({dom:`__jgsty_${l()}__`,css:".jg-hide{display:none!important}.jg-hide.jg-hide-enter,.jg-hide.jg-hide-leave{display:block!important}"}),this.m.forEach((t=>{this.create(t)})))}remove(t){if(!t)return;const e=this.m.get(t.id);e&&(e.refs--,e.refs>0||(this.m.delete(e.id),0!==this.s&&document.head.removeChild(document.getElementById(e.dom))))}},B=new Map;function G(t){let e=B.get(t);return e||(e=new Function("__ctx",`return \`${t.replace(/`/g,"\\`").replace(/\$\{\s*([\w\d._$]+)\s*\}/g,((t,e)=>"${ __ctx."+e+" }"))}\`;`),B.set(t,e)),e}function z(t,e){for(const n in e)n in t||(t[n]=e[n])}function Y(t){if(!t.__data)throw new Error("i18n data not found. Forgot to load i18n resource script?")}const q=new class extends V{constructor(){super(),this.__deps=null,this.__data=null,this.__cache=new Map,this.__key=null,this.__loader=null;const t=window.JINGE_I18N_DATA;t&&this.__regLoc(t)}get locale(){return Y(this),this.__data.locale}__regDep(t,e){const n=this.__deps||(this.__deps=[]);if(n[t]){if(n[t]!==e)throw new Error(`conflict at ${t}`)}else n[t]=e}__regLoc(t){const e=this.__cache;e.has(t.locale)||e.set(t.locale,{locale:t.locale,dictionary:null,render:{components:{},attributes:{}},__renders:[]});const n=e.get(t.locale);o(t.render)&&n.__renders.push(t.render),t.dictionary&&(n.dictionary?z(n.dictionary,t.dictionary):n.dictionary=t.dictionary),this.__data||(this.__data=n)}async switch(t,e){var r;if(this.__data.locale===t)return;if(!e&&!(e=null===(r=this.__loader)||void 0===r?void 0:r._get(t)))throw new Error("filename required.");const s=l();this.__key=s,this.__notify("before-change",this.locale,t);let o=this.__cache.get(t);if(!o){const r=await(n(e)?(i=e,window.fetch(i).then((t=>t.text()))):e(t));if(new Function("jinge",r)({i18n:this}),this.__key!==s)return;o=this.__cache.get(t)}var i;this.__data=o,this.__loader&&(await this.__loader._load(t),this.__key!==s)||this.__notify("change",this.locale)}__t(t,e){Y(this);const r=this.__data.dictionary;if(!(t in r))return"i18n_missing";let s=r[t];return n(s)&&(171===s.charCodeAt(0)?(s=r[s.substring(1)],n(s)&&(s=G(s))):s=G(s),r[t]=s),s(e)}__r(t,e){Y(this);const r=this.__data.__renders,s=this.__data.render;if(r&&r.length>0){if(!this.__deps)throw new Error("missing deps");r.forEach((t=>{const e=t(...this.__deps);z(s.components,e.components),z(s.attributes,e.attributes)})),r.length=0}const o=s[e];if(!(t in o))throw new Error(`missing ${e} key: ${t}`);let i=o[t];return n(i)&&(o[t]=i=o[i]),i}watch(t,e=!1){return this.__on("change",t),e&&t(this.locale),()=>{this.__off("change",t)}}};var J,K,Q;(Q=J||(J={}))[Q.INITIALIZE=0]="INITIALIZE",Q[Q.RENDERED=1]="RENDERED",Q[Q.WILLDESTROY=2]="WILLDESTROY",Q[Q.DESTROIED=3]="DESTROIED",function(t){t[t.UNTOUCH=0]="UNTOUCH",t[t.TOUCHED=1]="TOUCHED",t[t.UNTOUCH_FREEZED=2]="UNTOUCH_FREEZED",t[t.TOUCHED_FREEZED=3]="TOUCHED_FREEZED"}(K||(K={}));const X=Symbol("__");function tt(t){return X in t}function et(t){if(!e(t)||s(t))throw new Error("attrs() traget must be plain object.");return function(t){const e=new U(t);return e.__notifiable=!1,e.proxy=new Proxy(t,{set:H})}(t)}class nt extends V{constructor(t){if(!e(t)||!(R in t))throw new Error("Attributes passed to Component constructor must be ViewModel. See https://[todo]");const n=t[X]||{};super(n.listeners),function(t){if(R in t)throw new Error("component has alreay been wrapped.");const e=new U(t);e.__notifiable=!1,e.proxy=new Proxy(t,{set:k})}(this),this[X]={passedAttrs:t,context:n.context||null,contextState:K.UNTOUCH,slots:n.slots,state:J.INITIALIZE,rootNodes:[],nonRootCompNodes:[],refs:null,relatedRefs:null,upNextMap:null,compStyle:n.compStyle||null,deregFns:null}}static create(t){return e(t=t||et({}))&&R in t||(t=et(t||{})),new this(t)[R].proxy}__addDeregisterFn(t){let e=this[X].deregFns;e||(this[X].deregFns=e=new Set),e.add(t)}__i18nWatch(t,e=!1){this.__addDeregisterFn(q.watch((e=>{t.call(this,e)}),e))}__domAddListener(t,e,n,r){const s=N(t,e,(t=>{n.call(this,t)}),r);return this.__addDeregisterFn(s),()=>{s(),this[X].deregFns.delete(s)}}__domPassListeners(t,e){if(this[X].state!==J.RENDERED)throw new Error("domPassListeners must be applied to component which is rendered.");const n=this[Z];n&&0!==n.size&&(t&&!s(t)?(e=t,t=null):e||(e=this.__firstDOM),e.nodeType===Node.ELEMENT_NODE&&n.forEach(((n,r)=>{t&&t.indexOf(r)>=0||n.forEach(((t,n)=>{const s=N(e,r,t&&(t.stop||t.prevent)?e=>{t.stop&&e.stopPropagation(),t.prevent&&e.preventDefault(),n.call(this,e)}:t=>{n.call(this,t)},t);this.__addDeregisterFn(s)}))})))}get __transitionDOM(){const t=this[X].rootNodes[0];return tt(t)?t.__transitionDOM:t}get __firstDOM(){const t=this[X].rootNodes[0];return tt(t)?t.__firstDOM:t}get __lastDOM(){const t=this[X].rootNodes,e=t[t.length-1];return tt(e)?e.__lastDOM:e}__render(){const t=this.constructor;let e=t.template;if(!e&&this[X].slots&&(e=this[X].slots.default),!o(e))throw new Error(`Template of ${t.name} not found. Forget static getter "template"?`);return W.add(t.style),e(this)}__renderToDOM(t,e=!0){if(this[X].state!==J.INITIALIZE)throw new Error("component has already been rendered.");const n=function(t){if(!s(t)||0===t.length)throw new Error("Render results of component is empty");return t}(this.__render());var r,o;W.attch(),e?(r=n,o=t,t.parentNode.replaceChild(w(r),o)):y(t,n),this.__handleAfterRender()}__destroy(t=!0){const e=this[X];e.state>J.WILLDESTROY||(e.state=J.WILLDESTROY,this[R].__notifiable=!1,e.passedAttrs[R].__notifiable=!1,this.__notify("before-destroy"),this.__beforeDestroy(),this.__handleBeforeDestroy(t),super.__off(),W.remove(this.constructor.style),e.passedAttrs[R].__destroy(),e.passedAttrs=null,this[R].__destroy(),e.upNextMap&&(e.upNextMap.forEach((t=>{m(t)})),e.upNextMap=null),e.relatedRefs&&(e.relatedRefs.forEach((t=>{const e=t.origin[X].refs;if(!e)return;const n=e.get(t.ref);s(n)?i(n,t.node||this):e.delete(t.ref)})),e.relatedRefs=null),e.deregFns&&(e.deregFns.forEach((t=>t())),e.deregFns.clear(),e.deregFns=null),e.state=J.DESTROIED,e.rootNodes=e.nonRootCompNodes=e.refs=e.slots=e.context=null)}__handleBeforeDestroy(t=!1){let e;this[X].nonRootCompNodes.forEach((t=>{t.__destroy(!1)})),this[X].rootNodes.forEach((n=>{tt(n)?n.__destroy(t):t&&(e||(e=n.parentNode),e.removeChild(n))}))}__handleAfterRender(){this[X].passedAttrs[R].__notifiable=!0,this[R].__notifiable=!0,this[X].rootNodes.forEach((t=>{tt(t)&&t.__handleAfterRender()})),this[X].nonRootCompNodes.forEach((t=>{tt(t)&&t.__handleAfterRender()})),this[X].state=J.RENDERED,this[X].contextState=this[X].contextState===K.TOUCHED?K.TOUCHED_FREEZED:K.UNTOUCH_FREEZED,this.__afterRender(),this.__notify("after-render")}__updateIfNeed(t,e=!0){if(this[X].state!==J.RENDERED)return;if(!1===t)return this.__update();if(o(t)||(t=this.__update),!e)return void t.call(this);let n=this[X].upNextMap;n||(n=this[X].upNextMap=new Map),n.has(t)||n.set(t,g((()=>{n.delete(t),t.call(this)})))}__update(t){}__setContext(t,e,n=!1){if(this[X].contextState===K.UNTOUCH_FREEZED||this[X].contextState===K.TOUCHED_FREEZED)throw new Error("Can't setContext after component has been rendered. Try put setContext code into constructor.");if(this[X].contextState===K.UNTOUCH&&(this[X].context=Object.assign({},this[X].context),this[X].contextState=K.TOUCHED),t in this[X].context&&!n)throw new Error(`Contenxt with key: ${t.toString()} is exist. Pass third argument forceOverride=true to override it.`);this[X].context[t]=e}__getContext(t){return this[X].context?this[X].context[t]:null}__setRef(t,e,n){let r=this[X].refs;r||(this[X].refs=r=new Map);let o=r.get(t);o?s(o)?o.push(e):(o=[o,e],r.set(t,o)):r.set(t,e);const i=tt(e);if(!i&&this===n)return;let a=(i?e:n)[X].relatedRefs;a||((i?e:n)[X].relatedRefs=a=[]),a.push({origin:this,ref:t,node:i?null:e})}__getRef(t){return this[X].state!==J.RENDERED&&c(`Warning: call __getRef before component '${this.constructor.name}' rendered will get nothing. see https://[TODO]`),this[X].refs?this[X].refs.get(t):null}__afterRender(){}__beforeDestroy(){}}var rt,st;nt[X]=!0,(st=rt||(rt={}))[st.ENTERING=1]="ENTERING",st[st.ENTERED=2]="ENTERED",st[st.LEAVING=3]="LEAVING",st[st.LEAVED=4]="LEAVED";const ot=new Map;function it(t){return new Promise(((e,n)=>{if(ot.has(t))return e();const r=x("link",{rel:"stylesheet",href:t});r.onload=()=>{ot.set(t,!0),e()},r.onerror=n,document.head.appendChild(r)}))}function at(t){return ot.has(t)?Promise.resolve():fetch(t).then((t=>t.text())).then((e=>{ot.set(t,!0),new Function("jinge",e)({i18n:q})}))}function lt(t,e,n,r,o){return e?s(e)?Promise.all(e.map((e=>t(o+e)))).then((()=>{r.add(n)})):t(o+e).then((()=>{r.add(n)})):(r.add(n),Promise.resolve())}const ct=new class{constructor(){this.meta=null,this._acs=new Set,this._lcs={style:new Set,locale:{}}}_get(t){return this.meta?this.meta.public+this.meta.locale[t].entry:null}async _load(t){if(0===this._acs.size)return;t||(t=q.locale);const e=this.meta;if(!e)throw new Error("meta required.");const n=[],r=e.public,s=this._lcs.style;let o=this._lcs.locale[t];o||(this._lcs.locale[t]=o=new Set),this._acs.forEach((i=>{s.has(i)||n.push(lt(it,e.style.chunks[i],i,s,r)),o.has(i)||n.push(lt(at,e.locale[t].chunks[i],i,o,r))})),n.length>0&&await Promise.all(n)}active(t){return this._acs.add(t),this._load()}deactive(t){this._acs.delete(t)}};function _t(t){return[(()=>{const e=x("div",t[X].compStyle,"Hello, World");return t[X].rootNodes.push(e),e})()]}var ht,dt;q.__loader=ct,ht=class extends nt{static get template(){return _t}},dt=document.getElementById("root-app"),ht.create(void 0).__renderToDOM(dt,dt!==document.body)})();
//# sourceMappingURL=bundle.min.js.map