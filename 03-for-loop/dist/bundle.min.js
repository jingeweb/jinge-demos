(()=>{"use strict";function t(t){return typeof t}function e(e){return null!==e&&"object"===t(e)}function n(e){return"string"===t(e)}function r(e){return"number"===t(e)&&!Number.isNaN(e)&&Number.isFinite(e)}function o(e){return"undefined"===t(e)}function s(t){return Array.isArray(t)}function i(e){return"function"===t(e)}function a(t,e){const n=t.indexOf(e);return!(n<0||(t.splice(n,1),0))}let c=!0;function l(...t){c&&console.warn(...t)}let u,h,_=0,f=1,d=!1;function p(t){u.delete(t)}function g(t){if(d)return void setTimeout(g,0,t);const e=u.get(t);if(e){d=!0;try{e()}finally{p(t),d=!1}}}const w="undefined"==typeof window?globalThis:window;if(o(w.setImmediate)){u=new Map;const t="setImmediate$"+(_++).toString(32)+"$";w.addEventListener("message",(e=>{e.source===window&&n(e.data)&&e.data.startsWith(t)&&g(Number(e.data.slice(t.length)))}),!1),h=function(e){w.postMessage(t+e,"*")}}const y=w.setImmediate||function(t){if(!i(t)||arguments.length>1)throw new Error("setImmediate require callback function.");return u.set(f,t),h(f),f++},m=w.clearImmediate||p;function x(t,n){e(n)&&(n=JSON.stringify(n)),t.textContent=n}function b(t=""){return document.createTextNode(e(t)?JSON.stringify(t):t)}function N(t){const e=document.createDocumentFragment();return t?.forEach((t=>{e.appendChild(n(t)?document.createTextNode(t):t)})),e}function E(t,e){t.appendChild(e.length>1?N(e):n(e[0])?b(e[0]):e[0])}function v(t,n){if(n){if(!e(n))return t.removeAttribute(n);for(const e in n)v(t,e)}}function R(t,n,r){if(n)if(e(n))for(const e in n)R(t,e,n[e]);else o(r)||null===r?v(t,n):t.setAttribute(n,r)}function D(t,e,...n){return function(t,e,n){if(e)for(const n in e)n&&!o(e[n])&&R(t,n,e[n]);return n.length>0&&E(t,n),t}(document.createElement(t),e,n)}function O(t,...e){return D(t,null,...e)}function M(t,e,n){const r=n.nextSibling;r?t.insertBefore(e,r):t.appendChild(e)}function C(t,e,n,r){o(r)&&(r=!!e.startsWith("touch")&&{capture:!1,passive:!0}),t.addEventListener(e,n,r)}function S(t,e,n,r){return C(t,e,n,r),function(){!function(t,e,n){t.removeEventListener(e,n)}(t,e,n)}}const k=Symbol("$$");function I(t){const e=t.constructor;return e===RegExp||e===Date||e===Boolean}function A(t){return e(t)&&k in t}function F(t){return n(t)&&95!==t.charCodeAt(0)}function $(t){return n(t)?t:null===t?"null":o(t)?"undefined":t.toString()}function L(t){return n(t)?t.indexOf(".")>0?t.split("."):[t]:s(t)?t:[t]}function T(t,e,n){t.__parents||(t.__parents=[]),t.__parents.push({core:e,prop:n})}function P(t,e,n){if(!t.__parents)return;const r=t.__parents.findIndex((t=>t.core===e&&t.prop===n));r>=0&&t.__parents.splice(r,1)}function j(t,e,n,r){if(!t.__parents)return;const o=t.__parents.find((t=>t.core===e&&t.prop===n));o&&(o.prop+=r)}const V=new Map;function B(t){const e=V.get(t);e&&(m(e.immediate),V.delete(t))}function U(t,e,n){const r=e.__handlers;r?.forEach((e=>{n?e(t):function(t,e){if(V.has(t))return;const n=y((()=>{const e=V.get(t);try{t(e.propertyPath)}finally{V.delete(t)}}));V.set(t,{immediate:n,propertyPath:e})}(e,t)}));const o=e.__listeners;o?.forEach((e=>{U(t,e,n)}))}function W(t,e,n,r=0){const o=t.__listeners;if(!o)return;const s=$(e[r]);if(!s)return;let i=o.get(s);i&&(e.length-1===r?U(e,i,n):W(i,e,n,r+1)),i=o.get("*"),i&&(e.length-1===r?U(e,i,!0):W(i,e,n,r+1)),i=o.get("**"),i&&U(e,i,!0)}function z(t,e,n=0){const r=$(e[n]);t.__listeners||(t.__listeners=new Map);let o=t.__listeners.get(r);return o||(o={__parent:t,__property:r,__handlers:null,__listeners:null},t.__listeners.set(r,o)),e.length-1===n?o:z(o,e,n+1)}function J(t,e,n=0){const r=$(e[n]);if(!r)return null;const o=t.__listeners?.get(r);return o?e.length-1===n?o:J(o,e,n+1):null}function Y(t){const e=t.__listeners;e&&(e.forEach((t=>Y(t))),t.__listeners=null);const n=t.__handlers;n&&(n.forEach(B),t.__handlers=null),t.__parent=null}class Z{constructor(t){this.__notifiable=!0,this.__parents=null,this.__listeners=null,this.__related=null,this.__setters=null,this.target=t,this.proxy=null,Object.defineProperty(t,k,{value:this,writable:!1,configurable:!0,enumerable:!1})}__watch(t,e,n){const r=(t=L(t)).indexOf("**");if(r>=0&&r!==t.length-1)throw new Error('wizard "**" must be last element in path.');const o=z(this,t);o.__handlers||(o.__handlers=[]),o.__handlers.indexOf(e)<0&&o.__handlers.push(e),n&&n!==this&&n.__addRelated(this,t,e)}__unwatch(t,e,n){if(!t)return void Y(this);const r=J(this,L(t));if(!r)return;const o=r.__handlers;o&&(e?(B(e),a(o,e)):(o.forEach(B),o.length=0),function(t){if(t?.__handlers&&t.__handlers.length>0||t.__listeners&&t.__listeners.size>0)return null;const e=t.__parent,n=t.__property;t.__parent=null,e.__listeners.delete(n)}(r),n&&n!==this&&n.__rmRelated(this,t,e))}__notify(t,e=!1){if(!this.__notifiable)return;t=L(t),this.__listeners&&W(this,t,e);const n=this.__parents;n?.forEach((n=>{const r=n.core;r?r.__notify([n.prop].concat(t),e):console.error("dev-warn-unexpected: parent of ViewModelCore has been destroied but not unlink.")}))}__destroy(){this.__notifiable=!1,this.__parents=null,Y(this),this.proxy=null,this.__related&&(this.__related.forEach(((t,e)=>{t.forEach((t=>{e.__unwatch(t.prop,t.handler)}))})),this.__related=null);const t=this.target,n=this.__setters;n&&(n.forEach(((n,r)=>{if(null===n)return;const o=t[r];e(o)&&k in o&&P(o[k],this,r)})),this.__setters=null),Object.getOwnPropertyNames(t).forEach((n=>{const r=t[n];e(r)&&k in r&&P(r[k],this,n)})),delete t[k],this.target=null}__addRelated(t,e,n){this.__related||(this.__related=new Map);let r=this.__related.get(t);r||this.__related.set(t,r=[]),r.push({prop:e,handler:n})}__rmRelated(t,e,n){if(!this.__related)return;const r=this.__related.get(t);if(!r)return;const o=s(e),i=r.findIndex((t=>n===t.handler&&(o?function(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(e,t.prop):e===t.prop)));i>=0&&r.splice(i,1)}}function q(t,e){t[k].__notify(e)}function G(t,n,r,s,i=!0){if(!F(n))return t[n]=r,!0;const a=t[n];if(a===r&&!o(r))return!0;let c=e(r)&&!I(r);if(c&&(c=k in r,i&&!c))throw new Error(`public property "${n.toString()}" of ViewModel must also be ViewModel`);return e(a)&&k in a&&P(a[k],t[k],n),s(t,n,r),c&&T(r[k],t[k],n),q(t,n),!0}function K(t,e,n){t[e]=n}function X(t,e,n){const r=function(t,e){let n=t[k].__setters;if(n||(t[k].__setters=n=new Map),n.has(e))return n.get(e);{let r,o=t.constructor,s=Object.getOwnPropertyDescriptor(o.prototype,e);if(s)return r=i(s.set)?s.set:null,n.set(e,r),r;for(o=Object.getPrototypeOf(o);o?.prototype;){if(s=Object.getOwnPropertyDescriptor(o.prototype,e),s)return r=i(s.set)?s.set:null,n.set(e,r),r;o=Object.getPrototypeOf(o)}return n.set(e,null),null}}(t,e);r?r.call(t[k].proxy,n):t[e]=n}function H(t,e,n){return!(k in t)||G(t,e,n,K)}function Q(t,e,n){return!(k in t)||G(t,e,n,K,!1)}function tt(t,e,n){return k in t?G(t,e,n,X):(l(`call setter "${e.toString()}" after destroied, resources such as setInterval maybe not released before destroy. component:`,t),!0)}function et(t,e,n){let r=e;for(e>n&&(r=n,n=e);r<n;r++)q(t,r)}const nt={set:H},rt={get(t,e){if("then"===e||"catch"===e){const n=t[e];return function(...e){return n.call(t,...e)}}return t[e]},set:H};function ot(t,e){return t.forEach(((e,n)=>{A(e)&&T(e[k],t[k],n)})),e(),t.forEach(((e,n)=>{A(e)&&P(e[k],t[k],n)})),et(t,0,t.length),t[k].proxy}function st(t,e=!1){const n=ut(t,!0);return t.forEach(((n,r)=>{A(n)?T(n[k],t[k],r):e&&(t[r]=_t(n))})),n}function it(t,e){t.forEach(((n,r)=>{A(n)&&j(n[k],t[k],r,e)}))}function at(t,n){if(e(t)){if(k in t)return!0;throw new Error(`argument passed to Array.${n} must be ViewModel if the array is ViewModel`)}return!1}const ct={splice(t,e,n,...r){e<0&&(e=0),r.forEach(((n,r)=>{at(n,"splice")&&T(n[k],t[k],e+r)}));for(let r=0;r<n&&!(e+r>=t.length);r++){const n=t[e+r];A(n)&&P(n[k],t[k],e+r)}const o=r.length-n;if(0!==o)for(let r=e+n;r<t.length;r++){const e=t[r];A(e)&&j(e[k],t[k],r,o)}const s=st(t.splice(e,n,...r));if(0!==o){q(t,"length");for(let n=e;n<t.length;n++)q(t,n)}return s},shift(t){if(0===t.length)return t.shift();it(t,-1);const e=t.shift();A(e)&&P(e[k],t[k],-1),q(t,"length");for(let e=0;e<t.length+1;e++)q(t,e);return e},unshift(t,...e){if(0===e.length)return t.unshift();e.forEach(((e,n)=>{at(e,"unshift")&&T(e[k],t[k],n)})),it(t,e.length);const n=t.unshift(...e);q(t,"length");for(let e=0;e<t.length;e++)q(t,e);return n},pop(t){if(0===t.length)return t.pop();const e=t.pop();return A(e)&&P(e[k],t[k],t.length),q(t,"length"),q(t,t.length),e},push(t,...e){if(0===e.length)return 0;e.forEach(((e,n)=>{at(e,"push")&&T(e[k],t[k],t.length+n)}));const n=t.push(...e);q(t,"length");for(let n=t.length-e.length;n<t.length;n++)q(t,n);return n},fill:(t,e)=>(at(e,"fill"),t.forEach(((n,r)=>{(n!==e||o(n))&&(A(n)&&P(n[k],t[k],r),t[r]=e,A(e)&&T(e[k],t[k],r),q(t,r))})),t[k].proxy),reverse:t=>ot(t,(()=>t.reverse())),sort:(t,e)=>ot(t,(()=>t.sort(e))),concat:(t,e)=>(at(e,"concat"),st(t.concat(e))),filter:(t,e)=>st(t.filter(e)),slice:(t,e,n)=>st(t.slice(e,n)),map:(t,e)=>st(t.map(e),!0)},lt={get(t,e){if(e in ct){const n=ct[e];return function(...e){return n(t,...e)}}return t[e]},set:function(t,e,n){return!(k in t)||("length"===e?function(t,e){if(!r(e))throw new Error("bad argument. array length must be validate number.");const n=t.length;if(n>e)for(let r=e;r<n;r++){const e=t[r];A(e)&&P(e[k],t[k],r)}return t.length=e,n!==e&&(q(t,"length"),et(t,n,e)),!0}(t,n):G(t,e,n,K))}};function ut(t,n){return new Z(t).proxy=new Proxy(t,n?lt:e(r=t)&&i(r.then)?rt:nt);var r}function ht(t,n,r){e(n)&&!I(n)&&(k in n||(t[r]=n=_t(n)),T(n[k],t[k],r))}function _t(t){if(e(t)){if(I(t)||k in t)return t;const e=s(t),n=ut(t,e);if(e)for(let e=0;e<t.length;e++)ht(t,t[e],e);else for(const e in t)F(e)&&ht(t,t[e],e);return n}return t}function ft(t){if(!e(t))throw new Error("vm() target must be object or array.");return _t(t)}const dt=Symbol("listeners");class pt{constructor(t){if(this[dt]=null,t)for(const e in t){const n=t[e];this.__on(e,n.fn,n.opts)}}async __notify(t,...e){if(!this[dt])return;const n=this[dt].get(t);if(n)for await(const[r,o]of n){try{await r(...e)}catch(e){console.error("failed __notify",t,"due to:",e)}o?.once&&n.delete(r)}}__on(t,e,n){this[dt]||(this[dt]=new Map);let r=this[dt].get(t);return r||this[dt].set(t,r=new Map),r.set(e,n),()=>{this.__off(t,e)}}__off(t,e){const n=this[dt];if(!n)return;if(!t)return n.forEach((t=>t.clear())),void n.clear();const r=n.get(t);r&&(e?r.delete(e):r.clear())}}const gt=".jg-hide{display:none!important}.jg-hide.jg-hide-enter,.jg-hide.jg-hide-leave{display:block!important}";let wt=!1;!function(){if(wt)return;wt=!0;const t=D("style",{type:"text/css"});t.styleSheet?t.styleSheet.cssText=gt:t.textContent=gt,document.head.appendChild(t)}();var yt=(t=>(t[t.INITIALIZE=0]="INITIALIZE",t[t.RENDERED=1]="RENDERED",t[t.WILLDESTROY=2]="WILLDESTROY",t[t.DESTROIED=3]="DESTROIED",t))(yt||{});const mt=Symbol("__");function xt(t){return mt in t}function bt(t){if(!s(t)||0===t.length)throw new Error("Render results of component is empty");return t}function Nt(t){if(!e(t)||s(t))throw new Error("attrs() traget must be plain object.");return function(t){const e=new Z(t);return e.__notifiable=!1,e.proxy=new Proxy(t,{set:Q})}(t)}class Et extends pt{constructor(t){if(!e(t)||!(k in t))throw new Error("Attributes passed to Component constructor must be ViewModel. See https://[todo]");const n=t[mt]||{};super(n.listeners),function(t){if(k in t)throw new Error("component has alreay been wrapped.");const e=new Z(t);e.__notifiable=!1,e.proxy=new Proxy(t,{set:tt})}(this),this[mt]={passedAttrs:t,context:n.context||null,contextState:0,slots:n.slots,state:0,rootNodes:[],nonRootCompNodes:[],refs:null,relatedRefs:null,upNextMap:null,deregFns:null};const r=this[k].proxy;["class","style"].forEach((e=>{if(!(e in t))return;const n=()=>r[e]=t[e];n(),t[k].__watch(e,n)}))}static create(t){const n=e(t);return new this(n&&k in t?t:Nt(n?t:{}))[k].proxy}__addDeregisterFn(t){let e=this[mt].deregFns;e||(this[mt].deregFns=e=new Set),e.add(t)}__domAddListener(t,e,n,r){const o=S(t,e,(t=>{n.call(this,t)}),r);return this.__addDeregisterFn(o),()=>{o(),this[mt].deregFns.delete(o)}}__domPassListeners(t,e){if(1!==this[mt].state)throw new Error("domPassListeners must be applied to component which is rendered.");const n=this[dt];n&&0!==n.size&&(t&&!s(t)?(e=t,t=null):e||(e=this.__firstDOM),e.nodeType===Node.ELEMENT_NODE&&n.forEach(((n,r)=>{t&&t.indexOf(r)>=0||n.forEach(((t,n)=>{const o=S(e,r,t&&(t.stop||t.prevent)?e=>{t.stop&&e.stopPropagation(),t.prevent&&e.preventDefault(),n.call(this,e)}:t=>{n.call(this,t)},t);this.__addDeregisterFn(o)}))})))}get __transitionDOM(){const t=this[mt].rootNodes[0];return xt(t)?t.__transitionDOM:t}get __firstDOM(){const t=this[mt].rootNodes[0];return xt(t)?t.__firstDOM:t}get __lastDOM(){const t=this[mt].rootNodes,e=t[t.length-1];return xt(e)?e.__lastDOM:e}__doRender(){const t=this.constructor;let e=t.template;if(!e&&this[mt].slots&&(e=this[mt].slots.default),!i(e))throw new Error(`Template of ${t.name} not found. Forget static getter "template"?`);return e(this)}async __render(){return await this.__beforeRender(),await this.__notify("before-render"),bt(await this.__doRender())}async __renderToDOM(t,e=!0){if(0!==this[mt].state)throw new Error("component has already been rendered.");const n=bt(await this.__render());var r,o;e?(r=n,o=t,t.parentNode.replaceChild(N(r),o)):E(t,n),await this.__handleAfterRender()}async __destroy(t=!0){const e=this[mt];if(!(e.state>2)){if(e.state=2,this[k].__notifiable=!1,e.passedAttrs[k].__notifiable=!1,await this.__notify("before-destroy"),await this.__beforeDestroy(),await this.__handleBeforeDestroy(t),super.__off(),e.passedAttrs[k].__destroy(),e.passedAttrs=null,this[k].__destroy(),e.upNextMap&&(e.upNextMap.forEach((t=>{m(t)})),e.upNextMap=null),e.relatedRefs&&(e.relatedRefs.forEach((t=>{const e=t.origin[mt].refs;if(!e)return;const n=e.get(t.ref);s(n)?a(n,t.node||this):e.delete(t.ref)})),e.relatedRefs=null),e.deregFns){for await(const t of Array.from(e.deregFns))await t();e.deregFns.clear(),e.deregFns=null}e.state=3,e.rootNodes=e.nonRootCompNodes=e.refs=e.slots=e.context=null}}async __handleBeforeDestroy(t=!1){for await(const t of this[mt].nonRootCompNodes)await t.__destroy(!1);let e;for await(const n of this[mt].rootNodes)xt(n)?await n.__destroy(t):t&&(e||(e=n.parentNode),e.removeChild(n))}async __handleAfterRender(){this[mt].passedAttrs[k].__notifiable=!0,this[k].__notifiable=!0;for await(const t of this[mt].rootNodes)xt(t)&&await t.__handleAfterRender();for await(const t of this[mt].nonRootCompNodes)await t.__handleAfterRender();this[mt].state=1,this[mt].contextState=1===this[mt].contextState?3:2,await this.__afterRender(),await this.__notify("after-render")}__updateIfNeed(t,e=!0){if(1!==this[mt].state)return;if(!1===t)return void this.__update();if(i(t)||(t=this.__update),!e)return void t.call(this);let n=this[mt].upNextMap;n||(n=this[mt].upNextMap=new Map),n.has(t)||n.set(t,y((()=>{n.delete(t),t.call(this)})))}__update(t){}__setContext(t,e,n=!1){if(2===this[mt].contextState||3===this[mt].contextState)throw new Error("Can't setContext after component has been rendered. Try put setContext code into constructor.");if(0===this[mt].contextState&&(this[mt].context=Object.assign({},this[mt].context),this[mt].contextState=1),t in this[mt].context&&!n)throw new Error(`Contenxt with key: ${t.toString()} is exist. Pass third argument forceOverride=true to override it.`);this[mt].context[t]=e}__getContext(t){return this[mt].context?.[t]}__setRef(t,e,n){let r=this[mt].refs;r||(this[mt].refs=r=new Map);let o=r.get(t);o?s(o)?o.push(e):(o=[o,e],r.set(t,o)):r.set(t,e);const i=xt(e);if(!i&&this===n)return;let a=(i?e:n)[mt].relatedRefs;a||((i?e:n)[mt].relatedRefs=a=[]),a.push({origin:this,ref:t,node:i?null:e})}__getRef(t){return 1!==this[mt].state&&l(`Warning: call __getRef before component '${this.constructor.name}' rendered will get nothing. see https://[TODO]`),this[mt].refs?.get(t)}__beforeRender(){}__afterRender(){}__beforeDestroy(){}}Et[mt]=!0;class vt extends Et{constructor(t,e,n,r){super(t);const o=this[k].proxy;A(e)?o.each=e:o._e=e,o.index=n,o.isFirst=0===n,o.isLast=r}get each(){return this._e}set each(t){this._e=t}}function Rt(t,e,n,r,o){return new vt(Nt({[mt]:{context:o,slots:{default:r}}}),t,e,n)[k].proxy}function Dt(t,e,n,r,o,s){const i=Rt(t,e,n,r,s);return o.push(i),i.__render()}function Ot(t,e,n,r){const o="each"===r?t:r(t);return n.has(o)&&console.error(`loop items [${e}] and [${n.get(o)}] of <for> component both have key '${o}', dulplicated key may cause update error.`),n.set(o,e),o}async function Mt(t,e,n,r,o,s){const i=[],a=new Map;for(let c=0;c<t.length;c++){const l=t[c];"index"!==o&&r.push(Ot(l,c,a,o));const u=await Dt(l,c,c===t.length-1,e,n,s);i.push(...u)}return i}function Ct(t,e){e[mt].rootNodes.forEach((e=>{xt(e)?Ct(t,e):t.appendChild(e)}))}function St(t,e,n){t.isFirst!==(0===e)&&(t.isFirst=0===e),t.isLast!==(e===n.length-1)&&(t.isLast=e===n.length-1),t.index!==e&&(t.index=e),t.each!==n[e]&&(t.each=n[e])}function kt(t){return n(t)&&"length"!==t&&/^\d+$/.test(t)?Number(t):t}class It extends Et{constructor(t){if(t.key&&!/^(index|each(.[\w\d$_]+)*)$/.test(t.key))throw new Error('Value of "key" attribute of <for> component is invalidate. See https://[todo]');super(t);const e=this[k].proxy;o(t.loop)||null===t.loop||A(t.loop)?(e.loop=t.loop,t[k].__watch("loop",(()=>{e.loop=t.loop}))):e._l=t.loop;const n=t.key||"index";if(e._keyName=n,e._length=0,e._keys=null,e._waitingUpdate=!1,"index"!==n&&"each"!==n){e._keyName=new Function("each",`return ${n}`);const t=n.split(".").length+1;e[k].__watch("loop.*."+n.slice(5),(n=>{if(n.length!==t||e._waitingUpdate)return;const o=e.loop;if(!s(o)||0===o.length)return;const i=kt(n[1]);!r(i)||i>=o.length||(e._keys[i]=e._keyName(o[i]))}))}e[k].__watch("loop.*",(t=>{if(e[mt].state!==yt.RENDERED||2!==t.length||e._waitingUpdate)return;const n=kt(t[1]);"length"===n?(e._waitingUpdate=!0,e.__updateIfNeed()):r(n)&&e._updateItem(n)}))}get loop(){return this._l}set loop(t){this._l=t,this._waitingUpdate=!0,this.__updateIfNeed()}__doRender(){const t=this[mt].rootNodes,e=this[mt].slots?.default;if(!e)return t.push(document.createComment("empty")),t;const n=this.loop,r=this._keyName;return"index"!==r&&(this._keys=[]),s(n)&&0!==n.length?(this._length=n.length,Mt(n,e,t,this._keys,r,this[mt].context)):(t.push(document.createComment("empty")),t)}async _updateItem(t){const e=this.loop,n=this[mt].rootNodes;if(!s(e)||t>=n.length)return;const r=this._keys,o=e[t],i=n[t];if(i.each===o)return;const a=this[mt].slots?.default;if(!a)return;const c=this._keyName;if("index"!==c){const e="each"===c?o:c(o);if(e!==r[t]){const s=i.__firstDOM,c=Rt(o,t,i.isLast,a,this[mt].context),l=await c.__render();s.parentNode.insertBefore(l.length>1?N(l):l[0],s),i.__destroy(),n[t]=c,r[t]=e,await c.__handleAfterRender()}else i.each=o}else i.each=o}async __update(){this._waitingUpdate=!1;const t=this[mt].slots?.default;if(!t)return;const e=s(this.loop)?this.loop:[],n=this[mt].rootNodes,r=e.length,o=this._length;if(0===r&&0===o)return;const i=this._keyName;if(0===r&&o>0){const t=n[0].__firstDOM,e=document.createComment("empty");t.parentNode.insertBefore(e,t);for(let t=0;t<o;t++)await n[t].__destroy();return n.length=1,n[0]=e,"index"!==i&&(this._keys.length=0),void(this._length=0)}this._length=r;const a=this[mt].context,c=n[0],l=(0===o?c:c.__firstDOM).parentNode;if("index"===i){let s=null;0===o&&(n.length=0);for(let i=0;i<r;i++)i<o?St(n[i],i,e):(s||(s=N()),(await Dt(e[i],i,i===r-1,t,n,a)).forEach((t=>{s.appendChild(t)})));if(s){const t=0===o?c:n[o-1].__lastDOM;M(l,s,t);for(let t=o;t<r;t++)await n[t].__handleAfterRender()}if(0===o&&l.removeChild(c),r>=o)return;for(let t=r;t<o;t++)await n[t].__destroy();return void n.splice(r)}const u=this._keys;if(0===o){n.length=0,M(l,N(await Mt(e,t,n,u,i,this[mt].context)),c),l.removeChild(c);for await(const t of n)await t.__handleAfterRender();return}const h=new Map;u.forEach(((t,e)=>{h.set(t,e)}));const _=[],f=new Map;e.forEach(((t,e)=>{_.push(Ot(t,e,f,i))}));let d=0,p=0,g=null;const w=[],y=new Uint8Array(o);for(;d<o||p<r;){for(;d<o;)if(0!==y[d])d++;else{if(f.has(u[d])&&f.get(u[d])>=p){d===o-1&&(g=n[d].__lastDOM.nextSibling);break}d===o-1&&(g=n[d].__lastDOM.nextSibling),n[d].__destroy(),d++}if(d>=o){let n=null;const o=w.length;for(;p<r;p++){const o=Rt(e[p],p,p===r-1,t,a);n||(n=N()),(await o.__render()).forEach((t=>n.appendChild(t))),w.push(o)}if(n){g?l.insertBefore(n,g):l.appendChild(n);for(let t=o;t<w.length;t++)await w[t].__handleAfterRender()}break}const s=u[d];let i=null,c=null;for(;p<r;){const o=_[p];if(o===s)break;let l=null;if(h.has(o)){const t=h.get(o);t>d&&0===y[t]&&(l=n[t],y[t]=1)}i||(i=N()),l?(Ct(i,l),St(l,p,e)):(l=Rt(e[p],p,p===r-1,t,a),(await l.__render()).forEach((t=>i.appendChild(t))),c||(c=[]),c.push(l)),w.push(l),p++}if(p>=r)throw new Error("unimpossible?!");const m=n[d];if(i&&l.insertBefore(i,m.__firstDOM),c?.length)for await(const t of c)await t.__handleAfterRender();St(m,p,e),w.push(m),d++,p++}this[mt].rootNodes=w,this._keys=_}}function At(t,e){const n=Nt({[mt]:{context:e,slots:{default:t}}});return Et.create(n)}class Ft extends Et{constructor(t){super(t);const e=this[k].proxy;e._currentValue="default",e._previousValue=null;const n=()=>{e.expect=t.expect};n(),t[k].__watch("expect",n)}get expect(){return"default"===this._currentValue}set expect(t){const e=t?"default":"else";this._currentValue!==e&&(this._currentValue=e,this.__updateIfNeed())}get _branch(){return this.expect}__doRender(){return function(t){const e=t._currentValue,n=t[mt].slots,r=n?n[e]:null,o=t[mt].rootNodes;if(!r)return o.push(document.createComment("empty")),o;const s=At(r,t[mt].context);return o.push(s),s.__render()}(this)}__update(){if(xt(this[mt].rootNodes[0])||this[mt].slots?.[this._currentValue])return async function(t){const e=t[mt].rootNodes,n=e[0],r=xt(n),o=r?n.__firstDOM:n,s=(r?o:n).parentNode,i=t[mt].slots?.[t._currentValue];if(i){const n=At(i,t[mt].context),r=await n.__render();s.insertBefore(r.length>1?N(r):r[0],o),e[0]=n}else e[0]=document.createComment("empty"),s.insertBefore(e[0],o);r?await n.__destroy():s.removeChild(o),i&&await e[0].__handleAfterRender(),await t.__notify("branch-switched",t._branch)}(this)}}function $t(t,e){const n=b(e);return t[mt].rootNodes.push(n),n}async function Lt(t){const e=t;return[(()=>{const e=O("h2","Simple Array For-loop");return t[mt].rootNodes.push(e),e})(),await(async()=>{const n=O("div",O("p",...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){const e=t;return[...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){return[$t(t,"First:")]}}},expect:void 0}),r=()=>{n.expect=e.isFirst};r(),e[k].__watch(["isFirst"],r,t[k]);const o=Ft.create(n);return t[mt].rootNodes.push(o),o.__render()})(),(()=>{const n=b(),r=()=>{x(n,`${e.index}: ${e.each}`)};return r(),e[k].__watch(["index"],r,t[k]),e[k].__watch(["each"],r,t[k]),t[mt].rootNodes.push(n),n})(),...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){return[$t(t,";")]}}},expect:void 0}),r=()=>{n.expect=!e.isLast};r(),e[k].__watch(["isLast"],r,t[k]);const o=Ft.create(n);return t[mt].rootNodes.push(o),o.__render()})()]}}},loop:void 0}),r=()=>{n.loop=e.numbers};r(),e[k].__watch(["numbers"],r,t[k]);const o=It.create(n);return t[mt].nonRootCompNodes.push(o),o.__render()})()),O("div",(()=>{const t=O("button","Test");return C(t,"click",(function(...t){e.test(...t)})),t})(),(()=>{const t=O("button","Push Large");return C(t,"click",(function(...t){e.push(...t)})),t})()));return t[mt].rootNodes.push(n),n})(),(()=>{const e=O("h2","For & If");return t[mt].rootNodes.push(e),e})(),await(async()=>{const n=O("div",O("p",...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){const e=t;return[...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){return[(()=>{const e=O("span","odd:");return t[mt].rootNodes.push(e),e})()]},else:async function(t){return[(()=>{const e=O("span","even:");return t[mt].rootNodes.push(e),e})()]}}},expect:void 0}),r=()=>{n.expect=e.index%2==0};r(),e[k].__watch(["index"],r,t[k]);const o=Ft.create(n);return t[mt].rootNodes.push(o),o.__render()})(),...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){return[(()=>{const n=D("span",{style:"margin-right: 10px;"},(()=>{const n=b(),r=()=>{x(n,`${e.index}: ${e.each};`)};return r(),e[k].__watch(["index"],r,t[k]),e[k].__watch(["each"],r,t[k]),n})());return t[mt].rootNodes.push(n),n})()]}}},expect:void 0}),r=()=>{n.expect=e.each%2==0};r(),e[k].__watch(["each"],r,t[k]);const o=Ft.create(n);return t[mt].rootNodes.push(o),o.__render()})(),...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){return[(()=>{const n=D("span",{style:"margin-right: 10px; color: blue;"},(()=>{const n=b(),r=()=>{x(n,e.each)};return r(),e[k].__watch(["each"],r,t[k]),n})());return t[mt].rootNodes.push(n),n})()]}}},expect:void 0}),r=()=>{n.expect=e.each%2==1};r(),e[k].__watch(["each"],r,t[k]);const o=Ft.create(n);return t[mt].rootNodes.push(o),o.__render()})()]}}},loop:void 0,key:"each"}),r=()=>{n.loop=e.numbers};r(),e[k].__watch(["numbers"],r,t[k]);const o=It.create(n);return t[mt].nonRootCompNodes.push(o),o.__render()})()));return t[mt].rootNodes.push(n),n})(),(()=>{const e=O("h2","Key: id");return t[mt].rootNodes.push(e),e})(),await(async()=>{const n=O("div",O("p",O("ul",...await(()=>{const n=Nt({[mt]:{context:t[mt].context,slots:{default:async function(t){const e=t;return[(()=>{const n=O("li",(()=>{const n=b(),r=()=>{x(n,e.each?.name)};return r(),e[k].__watch(["each","name"],r,t[k]),n})());return t[mt].rootNodes.push(n),n})()]}}},loop:void 0,key:"each.id"}),r=()=>{n.loop=e.persons};r(),e[k].__watch(["persons"],r,t[k]);const o=It.create(n);return t[mt].nonRootCompNodes.push(o),o.__render()})())));return t[mt].rootNodes.push(n),n})()]}let Tt=1e3;!async function(t,e,n){const r=t.create(void 0);await r.__renderToDOM(e,e!==document.body)}(class extends Et{static get template(){return Lt}constructor(t){super(t);const e=this[k].proxy;e.INC=10,e.numbers=ft([0,1,2]),e.persons=ft([{id:"001",name:"XiaoGe"},{id:"002",name:"Jinge"}]),setInterval((()=>{e.numbers.push(Tt++),e.persons.push(ft({id:Date.now().toString(32),name:Date.now().toString(32)}))}),3e3)}test(t){this.numbers=ft([6,0,7,3,2]),this.persons.length=0}push(){const t=[];for(let e=0;e<1e4;e++)t.push(Tt++);this.numbers.push(...t)}},document.getElementById("root-app"))})();
//# sourceMappingURL=bundle.min.js.map